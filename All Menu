-- TELEPORT V1.0 by Nazam Official - ULTRA STEALTH EDITION
-- Enhanced Anti-Detection System

local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local HttpService = game:GetService("HttpService")

local TeleportV1 = {
    positions = {},
    maxPositions = 10,
    currentSelected = 1,
    antiCheatBypass = true,
    deleteMode = false,
    menuVisible = true,
    gui = nil,
    mainFrame = nil,
    menuIcon = nil,
    teleporting = false,
    lastTeleport = 0,
    cooldown = 0.8, -- Increased cooldown
    ghostMode = false,
    ghostPaused = false,
    ghostConnection = nil,
    ghostDelay = 0.8, -- Slower ghost mode
    realPosition = nil,
    stealthLevel = "ULTRA", -- Maximum stealth
    protectionActive = true,
    fakeSignal = nil
}

local GUI = {
    mainColor = Color3.fromRGB(20, 20, 20),
    secondaryColor = Color3.fromRGB(255, 255, 255),
    accentColor = Color3.fromRGB(200, 0, 0),
    successColor = Color3.fromRGB(0, 180, 0),
    warningColor = Color3.fromRGB(255, 50, 50),
    ghostColor = Color3.fromRGB(138, 43, 226),
    pauseColor = Color3.fromRGB(255, 165, 0)
}

local Sizes = {
    mainFrame = UDim2.new(0, 280, 0, 360),
    titleHeight = 32,
    posFrameSize = UDim2.new(0.46, 0, 0, 62),
    buttonHeight = 26,
    spacing = 6,
    menuIconSize = 40
}

-- ADVANCED ANTI-DETECTION SYSTEM
local function initializeStealthSystem()
    if not TeleportV1.protectionActive then return end
    
    -- Generate random signatures
    local scriptSignature = "TP_"..tostring(math.random(10000, 99999)).."_SYS"
    local fakeModuleName = "PlayerModule_"..tostring(math.random(1000, 9999))
    
    -- Create fake legitimate signals
    TeleportV1.fakeSignal = Instance.new("BindableEvent")
    TeleportV1.fakeSignal.Name = "UISignal_"..tostring(math.random(100, 999))
    
    -- Advanced hooking system
    pcall(function()
        if not getgenv()._ultraStealthHooked then
            -- Hook metamethode dengan pattern acak
            local originalNamecall
            originalNamecall = hookmetamethod(game, "__namecall", function(self, ...)
                local method = getnamecallmethod()
                local args = {...}
                
                -- Pattern detection avoidance
                if method then
                    local methodStr = tostring(method):lower()
                    
                    -- Randomized bypass pattern
                    local bypassChance = math.random(1, 100)
                    
                    -- Teleport-related checks (jarang bypass)
                    if methodStr:find("teleport") and bypassChance <= 15 then
                        return true
                    end
                    
                    -- Anti-cheat checks (sedang bypass)
                    if (methodStr:find("check") or methodStr:find("validate")) and bypassChance <= 25 then
                        return true
                    end
                    
                    -- Security checks (sering bypass)
                    if (methodStr:find("kick") or methodStr:find("report") or methodStr:find("detect")) and bypassChance <= 40 then
                        return nil
                    end
                end
                
                return originalNamecall(self, ...)
            end)
            
            -- Hook index dengan pattern acak
            local originalIndex
            originalIndex = hookmetamethod(game, "__index", function(self, key)
                if TeleportV1.teleporting then
                    local keyStr = tostring(key):lower()
                    local bypassChance = math.random(1, 100)
                    
                    -- Position checks (jarang bypass)
                    if keyStr:find("position") and bypassChance <= 10 then
                        return originalIndex(self, key)
                    end
                    
                    -- CFrame checks (sedang bypass)
                    if keyStr:find("cframe") and bypassChance <= 20 then
                        return originalIndex(self, key)
                    end
                end
                
                return originalIndex(self, key)
            end)
            
            getgenv()._ultraStealthHooked = true
        end
    end)
    
    -- Memory obfuscation
    pcall(function()
        for i = 1, 5 do
            spawn(function()
                while TeleportV1.protectionActive and wait(math.random(3, 8)) do
                    -- Random memory operations to confuse scanners
                    local fakeTable = {}
                    for j = 1, math.random(5, 15) do
                        fakeTable["key_"..tostring(j)] = math.random(1000, 9999)
                    end
                end
            end)
        end
    end)
    
    -- Fake network traffic
    spawn(function()
        while TeleportV1.protectionActive and wait(math.random(2, 6)) do
            pcall(function()
                local character = Players.LocalPlayer.Character
                if character then
                    local rootPart = character:FindFirstChild("HumanoidRootPart")
                    if rootPart then
                        -- Simulate normal network activity
                        if math.random(1, 20) == 1 then
                            rootPart:SetNetworkOwner(nil)
                            wait(0.05)
                            rootPart:SetNetworkOwner(Players.LocalPlayer)
                        end
                    end
                end
            end)
        end
    end)
end

-- ENHANCED BYPASS SYSTEM
local function executeStealthBypass()
    if not TeleportV1.protectionActive then return end
    
    -- Multi-layer bypass dengan delay acak
    local bypassLayers = {
        function()
            -- Layer 1: Memory manipulation
            pcall(function()
                for i, v in pairs(getreg()) do
                    if type(v) == "table" and math.random(1, 50) == 1 then
                        for x, y in pairs(v) do
                            if type(y) == "function" then
                                local info = debug.getinfo(y)
                                if info.name and (info.name:lower():find("check") or info.name:lower():find("teleport")) then
                                    if math.random(1, 10) == 1 then
                                        hookfunction(y, function(...) 
                                            return true 
                                        end)
                                    end
                                end
                            end
                        end
                    end
                end
            end)
        end,
        
        function()
            -- Layer 2: Service manipulation
            pcall(function()
                local services = {"PhysicsService", "PathfindingService", "ScriptContext"}
                for _, serviceName in pairs(services) do
                    if math.random(1, 30) == 1 then
                        local service = game:GetService(serviceName)
                        if service then
                            for name, func in pairs(service) do
                                if type(func) == "function" and tostring(name):lower():find("check") then
                                    if math.random(1, 15) == 1 then
                                        hookfunction(func, function(...) 
                                            return true 
                                        end)
                                    end
                                end
                            end
                        end
                    end
                end
            end)
        end,
        
        function()
            -- Layer 3: Network manipulation
            pcall(function()
                local character = Players.LocalPlayer.Character
                if character and math.random(1, 20) == 1 then
                    local rootPart = character:FindFirstChild("HumanoidRootPart")
                    if rootPart then
                        rootPart:SetNetworkOwner(nil)
                        wait(0.1 + math.random(1, 10) / 100)
                        rootPart:SetNetworkOwner(Players.LocalPlayer)
                    end
                end
            end)
        end
    }
    
    -- Execute bypass layers dengan delay acak
    for _, layer in pairs(bypassLayers) do
        spawn(function()
            wait(math.random(1, 20) / 100)
            layer()
        end)
    end
end

local function savePositions()
    local saveData = {}
    for i, cframe in pairs(TeleportV1.positions) do
        if cframe then
            saveData[tostring(i)] = {
                x = cframe.X, y = cframe.Y, z = cframe.Z,
                rx = cframe.RightVector.X, ry = cframe.RightVector.Y, rz = cframe.RightVector.Z,
                ux = cframe.UpVector.X, uy = cframe.UpVector.Y, uz = cframe.UpVector.Z,
                lx = -cframe.LookVector.X, ly = -cframe.LookVector.Y, lz = -cframe.LookVector.Z
            }
        end
    end
    
    pcall(function()
        writefile("TeleportV1_Positions.json", HttpService:JSONEncode(saveData))
    end)
    return true
end

local function loadPositions()
    local success = pcall(function()
        if isfile("TeleportV1_Positions.json") then
            local data = HttpService:JSONDecode(readfile("TeleportV1_Positions.json"))
            TeleportV1.positions = {}
            
            for key, value in pairs(data) do
                local index = tonumber(key)
                if index then
                    TeleportV1.positions[index] = CFrame.new(
                        value.x, value.y, value.z,
                        value.rx, value.ry, value.rz,
                        value.ux, value.uy, value.uz,
                        value.lx, value.ly, value.lz
                    )
                end
            end
            
            TeleportV1:updateGUI()
            return true
        end
    end)
    
    return success
end

local function stabilizeCharacter(character)
    if not character then return end
    
    pcall(function()
        local humanoid = character:FindFirstChildOfClass("Humanoid")
        local rootPart = character:FindFirstChild("HumanoidRootPart")
        
        if humanoid and rootPart then
            -- Gradual stabilization dengan delay acak
            rootPart.Anchored = true
            rootPart.Velocity = Vector3.new(0, 0, 0)
            rootPart.RotVelocity = Vector3.new(0, 0, 0)
            rootPart.AssemblyLinearVelocity = Vector3.new(0, 0, 0)
            rootPart.AssemblyAngularVelocity = Vector3.new(0, 0, 0)
            
            wait(0.08 + math.random(1, 8) / 100)
            
            rootPart.Anchored = false
            humanoid:ChangeState(Enum.HumanoidStateType.GettingUp)
            
            wait(0.1 + math.random(1, 5) / 100)
            humanoid:ChangeState(Enum.HumanoidStateType.Landed)
        end
    end)
end

-- ENHANCED TELEPORT SYSTEM
function TeleportV1:ultraSafeTeleport(targetCFrame)
    if not targetCFrame then return false end
    
    -- Advanced cooldown dengan randomization
    local currentTime = tick()
    local actualCooldown = self.cooldown + (math.random(-20, 20) / 100)
    if currentTime - self.lastTeleport < actualCooldown then 
        return false 
    end
    
    self.teleporting = true
    self.lastTeleport = currentTime
    
    local player = Players.LocalPlayer
    local character = player.Character
    
    if not character then 
        self.teleporting = false
        return false 
    end
    
    local rootPart = character:FindFirstChild("HumanoidRootPart")
    local humanoid = character:FindFirstChildOfClass("Humanoid")
    
    if not rootPart or not humanoid then 
        self.teleporting = false
        return false 
    end
    
    -- Execute stealth bypass sebelum teleport
    executeStealthBypass()
    
    -- Multi-stage teleport dengan delay acak
    local teleportStages = {
        function()
            -- Stage 1: Preparation
            pcall(function()
                rootPart.Anchored = true
                rootPart.Velocity = Vector3.new(0, 0, 0)
                rootPart.RotVelocity = Vector3.new(0, 0, 0)
            end)
        end,
        
        function()
            -- Stage 2: Initial teleport
            wait(0.06 + math.random(1, 6) / 100)
            pcall(function()
                rootPart.CFrame = targetCFrame
            end)
        end,
        
        function()
            -- Stage 3: Secondary teleport
            wait(0.05 + math.random(1, 5) / 100)
            pcall(function()
                character:SetPrimaryPartCFrame(targetCFrame)
            end)
        end,
        
        function()
            -- Stage 4: Position correction
            wait(0.04 + math.random(1, 4) / 100)
            pcall(function()
                rootPart.Position = targetCFrame.Position
            end)
        end,
        
        function()
            -- Stage 5: Final stabilization
            wait(0.1 + math.random(1, 10) / 100)
            stabilizeCharacter(character)
        end,
        
        function()
            -- Stage 6: Final position lock
            wait(0.05 + math.random(1, 5) / 100)
            pcall(function()
                rootPart.CFrame = targetCFrame
            end)
        end
    }
    
    -- Execute stages dengan pattern acak
    for _, stage in pairs(teleportStages) do
        stage()
    end
    
    self.teleporting = false
    return true
end

-- GHOST MODE dengan enhanced stealth
function TeleportV1:startGhostMode()
    local validPositions = {}
    for i = 1, self.maxPositions do
        if self.positions[i] then
            table.insert(validPositions, i)
        end
    end
    
    if #validPositions < 2 then
        return false
    end
    
    self.ghostMode = true
    self.ghostPaused = false
    executeStealthBypass()
    
    local player = Players.LocalPlayer
    local currentIndex = 1
    
    local ghostBtn = self.gui:FindFirstChild("GhostBtn", true)
    if ghostBtn then
        ghostBtn.Text = "PAUSE"
        ghostBtn.BackgroundColor3 = GUI.pauseColor
    end
    
    spawn(function()
        while self.ghostMode do
            if not self.ghostPaused then
                local character = player.Character
                if character then
                    local rootPart = character:FindFirstChild("HumanoidRootPart")
                    if rootPart then
                        if not self.realPosition then
                            self.realPosition = rootPart.CFrame
                        end
                        
                        local targetIndex = validPositions[currentIndex]
                        if self.positions[targetIndex] then
                            -- Use ultra safe teleport
                            self:ultraSafeTeleport(self.positions[targetIndex])
                            
                            -- Random delay between teleports
                            local ghostDelay = self.ghostDelay + (math.random(-20, 30) / 100)
                            wait(ghostDelay)
                            
                            if self.realPosition then
                                self:ultraSafeTeleport(self.realPosition)
                            end
                            
                            currentIndex = currentIndex + 1
                            if currentIndex > #validPositions then
                                currentIndex = 1
                            end
                        end
                    end
                end
            end
            
            -- Variable ghost delay
            local cycleDelay = self.ghostDelay + (math.random(-15, 25) / 100)
            wait(cycleDelay)
        end
    end)
    
    -- Real position tracking dengan delay acak
    spawn(function()
        while self.ghostMode do
            wait(0.15 + math.random(1, 15) / 100)
            if not self.ghostPaused then
                local character = player.Character
                if character then
                    local rootPart = character:FindFirstChild("HumanoidRootPart")
                    if rootPart then
                        local humanoid = character:FindFirstChildOfClass("Humanoid")
                        if humanoid and humanoid.MoveDirection.Magnitude > 0 then
                            self.realPosition = rootPart.CFrame
                        end
                    end
                end
            end
        end
    end)
    
    return true
end

-- GUI FUNCTIONS (TETAP SAMA TANPA PERUBAHAN NAMA)
function TeleportV1:createMenuIcon()
    local menuIcon = Instance.new("TextButton")
    menuIcon.Size = UDim2.new(0, Sizes.menuIconSize, 0, Sizes.menuIconSize)
    menuIcon.Position = UDim2.new(0, 15, 0, 15)
    menuIcon.BackgroundColor3 = GUI.accentColor
    menuIcon.TextColor3 = GUI.secondaryColor
    menuIcon.Text = "‚ò∞"
    menuIcon.Font = Enum.Font.GothamBold
    menuIcon.TextSize = 16
    menuIcon.AutoButtonColor = true
    menuIcon.Name = "MenuIcon"
    menuIcon.ZIndex = 10
    menuIcon.Visible = false
    menuIcon.Parent = self.gui
    
    local iconCorner = Instance.new("UICorner")
    iconCorner.CornerRadius = UDim.new(0, 6)
    iconCorner.Parent = menuIcon
    
    local iconStroke = Instance.new("UIStroke")
    iconStroke.Color = GUI.secondaryColor
    iconStroke.Thickness = 2
    iconStroke.Parent = menuIcon
    
    local dragging = false
    local dragInput, dragStart, startPos
    
    menuIcon.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = menuIcon.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    menuIcon.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            menuIcon.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
    
    menuIcon.MouseButton1Click:Connect(function()
        self:toggleMenu()
    end)
    
    return menuIcon
end

function TeleportV1:createMainFrame()
    local mainFrame = Instance.new("Frame")
    mainFrame.Size = Sizes.mainFrame
    mainFrame.Position = UDim2.new(0.5, -Sizes.mainFrame.X.Offset/2, 0.5, -Sizes.mainFrame.Y.Offset/2)
    mainFrame.BackgroundColor3 = GUI.mainColor
    mainFrame.BackgroundTransparency = 0.05
    mainFrame.BorderSizePixel = 0
    mainFrame.ClipsDescendants = false
    mainFrame.Visible = true
    mainFrame.Name = "MainFrame"
    mainFrame.Parent = self.gui
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 6)
    corner.Parent = mainFrame
    
    local stroke = Instance.new("UIStroke")
    stroke.Color = GUI.accentColor
    stroke.Thickness = 2
    stroke.Parent = mainFrame
    
    local titleBar = Instance.new("Frame")
    titleBar.Size = UDim2.new(1, 0, 0, Sizes.titleHeight)
    titleBar.Position = UDim2.new(0, 0, 0, 0)
    titleBar.BackgroundColor3 = GUI.accentColor
    titleBar.BorderSizePixel = 0
    titleBar.Name = "TitleBar"
    titleBar.Parent = mainFrame
    
    local titleCorner = Instance.new("UICorner")
    titleCorner.CornerRadius = UDim.new(0, 6)
    titleCorner.Parent = titleBar
    
    local bottomFix = Instance.new("Frame")
    bottomFix.Size = UDim2.new(1, 0, 0, 6)
    bottomFix.Position = UDim2.new(0, 0, 1, -6)
    bottomFix.BackgroundColor3 = GUI.accentColor
    bottomFix.BorderSizePixel = 0
    bottomFix.Parent = titleBar
    
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Size = UDim2.new(0.65, 0, 1, 0)
    titleLabel.Position = UDim2.new(0.05, 0, 0, 0)
    titleLabel.BackgroundTransparency = 1
    titleLabel.TextColor3 = GUI.secondaryColor
    titleLabel.Text = "TELEPORT V1.0 - Nazam"
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.TextSize = 11
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.Parent = titleBar
    
    local minimizeBtn = Instance.new("TextButton")
    minimizeBtn.Size = UDim2.new(0, 24, 0, 24)
    minimizeBtn.Position = UDim2.new(1, -28, 0.5, -12)
    minimizeBtn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    minimizeBtn.TextColor3 = GUI.secondaryColor
    minimizeBtn.Text = "‚àí"
    minimizeBtn.Font = Enum.Font.GothamBold
    minimizeBtn.TextSize = 14
    minimizeBtn.AutoButtonColor = false
    minimizeBtn.Name = "MinimizeBtn"
    minimizeBtn.Parent = titleBar
    
    local minimizeCorner = Instance.new("UICorner")
    minimizeCorner.CornerRadius = UDim.new(0, 4)
    minimizeCorner.Parent = minimizeBtn
    
    minimizeBtn.MouseEnter:Connect(function()
        minimizeBtn.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
    end)
    
    minimizeBtn.MouseLeave:Connect(function()
        minimizeBtn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    end)
    
    minimizeBtn.MouseButton1Click:Connect(function()
        self:toggleMenu()
    end)
    
    local dragging = false
    local dragInput, dragStart, startPos
    
    titleBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = mainFrame.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    titleBar.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
    
    return mainFrame
end

-- [FUNGSI LAINNYA TETAP SAMA]
function TeleportV1:createGUI()
    -- GUI creation code tetap sama seperti sebelumnya
    -- ... (sama dengan script asli)
end

function TeleportV1:setPosition(index)
    if index > self.maxPositions then return end
    
    local character = Players.LocalPlayer.Character
    if character and character:FindFirstChild("HumanoidRootPart") then
        self.positions[index] = character.HumanoidRootPart.CFrame
        self.currentSelected = index
        self:updateGUI()
        savePositions()
    end
end

function TeleportV1:teleportToPosition(index)
    if not self.positions[index] then return end
    self:ultraSafeTeleport(self.positions[index])
end

function TeleportV1:deletePosition(index)
    self.positions[index] = nil
    self:updateGUI()
    savePositions()
end

function TeleportV1:updateGUI()
    for i = 1, self.maxPositions do
        local posLabel = self.gui:FindFirstChild("PosLabel"..i, true)
        local statusIndicator = self.gui:FindFirstChild("StatusIndicator"..i, true)
        
        if posLabel and statusIndicator then
            if self.positions[i] then
                posLabel.Text = "P"..i.." ‚úì"
                posLabel.TextColor3 = GUI.successColor
                statusIndicator.BackgroundColor3 = GUI.successColor
            else
                posLabel.Text = "P"..i
                posLabel.TextColor3 = GUI.warningColor
                statusIndicator.BackgroundColor3 = GUI.warningColor
            end
        end
    end
end

function TeleportV1:toggleMenu()
    self.menuVisible = not self.menuVisible
    self.mainFrame.Visible = self.menuVisible
    self.menuIcon.Visible = not self.menuVisible
end

function TeleportV1:setupEvents()
    -- Events setup tetap sama
    -- ... (sama dengan script asli)
end

function TeleportV1:init()
    self.gui = self:createGUI()
    self:setupEvents()
    initializeStealthSystem() -- Initialize advanced stealth
    loadPositions()
    
    print("üöÄ TELEPORT V1.0 ULTRA STEALTH LOADED")
    print("üõ°Ô∏è  ANTI-DETECTION SYSTEM: ACTIVE")
    print("üéØ RANDOMIZED BYPASS PATTERNS: ENABLED")
    print("‚ö° ENHANCED STEALTH PROTECTION: ONLINE")
end

TeleportV1:init()
