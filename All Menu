-- X - V3N0M v1.0 by Nazam Official
-- Advanced Checkpoint System with Position Save/Load

local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local HttpService = game:GetService("HttpService")

local VenomSystem = {
    positions = {},
    isRunning = false,
    currentIndex = 1,
    menuVisible = true,
    teleportCooldown = 0.8,
    lastTeleport = 0,
    lastClickTime = 0
}

-- Color Theme: Red, White, Black
local Theme = {
    primary = Color3.fromRGB(200, 0, 0),
    secondary = Color3.fromRGB(255, 255, 255),
    background = Color3.fromRGB(15, 15, 15),
    accent = Color3.fromRGB(150, 0, 0),
    success = Color3.fromRGB(0, 180, 0),
    warning = Color3.fromRGB(255, 80, 80),
    info = Color3.fromRGB(0, 120, 200)
}

-- Compact Sizes
local Sizes = {
    mainFrame = UDim2.new(0, 220, 0, 320),  -- Slightly taller for LOAD button
    titleHeight = 28,
    buttonHeight = 32,
    posItemHeight = 36,
    spacing = 5
}

-- Save positions to file
local function savePositions()
    local saveData = {}
    for i, pos in ipairs(VenomSystem.positions) do
        if pos then
            saveData[i] = {
                X = pos.X, Y = pos.Y, Z = pos.Z,
                RightX = pos.RightVector.X, RightY = pos.RightVector.Y, RightZ = pos.RightVector.Z,
                UpX = pos.UpVector.X, UpY = pos.UpVector.Y, UpZ = pos.UpVector.Z,
                LookX = pos.LookVector.X, LookY = pos.LookVector.Y, LookZ = pos.LookVector.Z
            }
        end
    end
    
    local success = pcall(function()
        writefile("venom_positions.json", HttpService:JSONEncode(saveData))
    end)
    
    return success
end

-- Load positions from file
local function loadPositions()
    local success, data = pcall(function()
        if isfile("venom_positions.json") then
            local fileData = readfile("venom_positions.json")
            return HttpService:JSONDecode(fileData)
        end
    end)
    
    if success and data then
        VenomSystem.positions = {}
        for i, posData in pairs(data) do
            if posData then
                VenomSystem.positions[tonumber(i)] = CFrame.new(
                    posData.X, posData.Y, posData.Z,
                    posData.RightX, posData.RightY, posData.RightZ,
                    posData.UpX, posData.UpY, posData.UpZ,
                    posData.LookX, posData.LookY, posData.LookZ
                )
            end
        end
        VenomSystem:updatePositionsList()
        return true
    end
    return false
end

-- Advanced Touch Part System (Checkpoint Detection)
local function triggerCheckpoint(cframe)
    local character = Players.LocalPlayer.Character
    if not character then return false end

    local rootPart = character:FindFirstChild("HumanoidRootPart")
    if not rootPart then return false end

    -- Store original position
    local originalPosition = rootPart.CFrame
    
    -- Method 1: Direct part touching simulation
    pcall(function()
        -- Temporarily move to checkpoint position
        rootPart.CFrame = cframe
        
        -- Wait a bit for detection
        wait(0.05)
        
        -- Fire touch events manually if needed
        local touchInterest = workspace:FindFirstChild("TouchInterest", true)
        if touchInterest then
            touchInterest:Fire()
        end
        
        -- Check for proximity prompts
        for _, obj in pairs(workspace:GetDescendants()) do
            if obj:IsA("ProximityPrompt") and (obj.WorldPosition - cframe.Position).Magnitude < 10 then
                obj:InputHoldBegin()
                wait(0.1)
                obj:InputHoldEnd()
            end
        end
    end)
    
    -- Method 2: Network ownership manipulation for better detection
    pcall(function()
        rootPart:SetNetworkOwner(nil)
        wait(0.02)
        rootPart:SetNetworkOwner(Players.LocalPlayer)
    end)
    
    -- Method 3: Return to original position (stealth)
    pcall(function()
        rootPart.CFrame = originalPosition
    end)
    
    return true
end

-- Auto Teleport Loop with Checkpoint Detection
local function startAutoTeleport()
    if #VenomSystem.positions == 0 then return end
    if VenomSystem.isRunning then return end
    
    VenomSystem.isRunning = true
    VenomSystem.currentIndex = VenomSystem.currentIndex or 1
    
    local startBtn = VenomSystem.gui:FindFirstChild("StartBtn", true)
    if startBtn then
        startBtn.Text = "RUNNING"
        startBtn.BackgroundColor3 = Theme.success
    end
    
    spawn(function()
        while VenomSystem.isRunning and #VenomSystem.positions > 0 do
            if VenomSystem.currentIndex > #VenomSystem.positions then
                VenomSystem.currentIndex = 1
            end
            
            local targetCFrame = VenomSystem.positions[VenomSystem.currentIndex]
            if targetCFrame then
                -- Trigger checkpoint detection
                triggerCheckpoint(targetCFrame)
                
                VenomSystem.currentIndex += 1
            end
            
            wait(VenomSystem.teleportCooldown + 0.1)
        end
    end)
end

-- Stop Auto Teleport
local function stopAutoTeleport()
    VenomSystem.isRunning = false
    
    local startBtn = VenomSystem.gui:FindFirstChild("StartBtn", true)
    if startBtn then
        startBtn.Text = "START"
        startBtn.BackgroundColor3 = Theme.primary
    end
end

-- Direct Teleport with Checkpoint
local function directTeleport(index)
    if VenomSystem.positions[index] then
        triggerCheckpoint(VenomSystem.positions[index])
    end
end

-- Add New Position with Auto-Save
local function addPosition()
    local character = Players.LocalPlayer.Character
    if character and character:FindFirstChild("HumanoidRootPart") then
        local newIndex = #VenomSystem.positions + 1
        VenomSystem.positions[newIndex] = character.HumanoidRootPart.CFrame
        VenomSystem:updatePositionsList()
        savePositions() -- Auto-save when adding new position
    end
end

-- Delete Position with Auto-Save
local function deletePosition(index)
    table.remove(VenomSystem.positions, index)
    
    local newPositions = {}
    for i, pos in ipairs(VenomSystem.positions) do
        newPositions[i] = pos
    end
    VenomSystem.positions = newPositions
    
    VenomSystem:updatePositionsList()
    savePositions() -- Auto-save when deleting position
end

-- Double Click Handler for LOAD button
local function handleDoubleClick(button)
    local currentTime = tick()
    if currentTime - VenomSystem.lastClickTime < 0.5 then -- Double click within 0.5 seconds
        -- Double click action: Replace with new positions
        local character = Players.LocalPlayer.Character
        if character and character:FindFirstChild("HumanoidRootPart") then
            VenomSystem.positions = {character.HumanoidRootPart.CFrame} -- Replace with current position
            VenomSystem:updatePositionsList()
            savePositions()
        end
        VenomSystem.lastClickTime = 0 -- Reset
    else
        -- Single click action: Load saved positions
        loadPositions()
        VenomSystem.lastClickTime = currentTime
    end
end

-- Create Compact GUI with LOAD Button
function VenomSystem:createGUI()
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "VenomV1_NazamOfficial"
    screenGui.ResetOnSpawn = false
    screenGui.Parent = Players.LocalPlayer:WaitForChild("PlayerGui")
    
    self.gui = screenGui
    
    -- Main Frame
    local mainFrame = Instance.new("Frame")
    mainFrame.Size = Sizes.mainFrame
    mainFrame.Position = UDim2.new(0, 10, 0, 10)
    mainFrame.BackgroundColor3 = Theme.background
    mainFrame.BackgroundTransparency = 0.1
    mainFrame.BorderSizePixel = 0
    mainFrame.ClipsDescendants = true
    mainFrame.Name = "MainFrame"
    mainFrame.Parent = screenGui
    
    local mainCorner = Instance.new("UICorner")
    mainCorner.CornerRadius = UDim.new(0, 6)
    mainCorner.Parent = mainFrame
    
    local mainStroke = Instance.new("UIStroke")
    mainStroke.Color = Theme.primary
    mainStroke.Thickness = 1
    mainStroke.Parent = mainFrame
    
    -- Title Bar
    local titleBar = Instance.new("Frame")
    titleBar.Size = UDim2.new(1, 0, 0, Sizes.titleHeight)
    titleBar.Position = UDim2.new(0, 0, 0, 0)
    titleBar.BackgroundColor3 = Theme.primary
    titleBar.BorderSizePixel = 0
    titleBar.Name = "TitleBar"
    titleBar.Parent = mainFrame
    
    local titleCorner = Instance.new("UICorner")
    titleCorner.CornerRadius = UDim.new(0, 6)
    titleCorner.Parent = titleBar
    
    -- Title Text
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Size = UDim2.new(0.6, 0, 1, 0)
    titleLabel.Position = UDim2.new(0.05, 0, 0, 0)
    titleLabel.BackgroundTransparency = 1
    titleLabel.TextColor3 = Theme.secondary
    titleLabel.Text = "V3N0M"
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.TextSize = 12
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.Parent = titleBar
    
    -- Close Button (X)
    local closeBtn = Instance.new("TextButton")
    closeBtn.Size = UDim2.new(0, 22, 0, 22)
    closeBtn.Position = UDim2.new(1, -25, 0.5, -11)
    closeBtn.BackgroundColor3 = Theme.accent
    closeBtn.TextColor3 = Theme.secondary
    closeBtn.Text = "X"
    closeBtn.Font = Enum.Font.GothamBold
    closeBtn.TextSize = 10
    closeBtn.AutoButtonColor = false
    closeBtn.Name = "CloseBtn"
    closeBtn.Parent = titleBar
    
    local closeCorner = Instance.new("UICorner")
    closeCorner.CornerRadius = UDim.new(0, 4)
    closeCorner.Parent = closeBtn
    
    closeBtn.MouseEnter:Connect(function()
        closeBtn.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
    end)
    
    closeBtn.MouseLeave:Connect(function()
        closeBtn.BackgroundColor3 = Theme.accent
    end)
    
    -- Make Draggable
    local dragging = false
    local dragInput, dragStart, startPos
    
    titleBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = mainFrame.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    titleBar.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            mainFrame.Position = UDim2.new(
                startPos.X.Scale, 
                startPos.X.Offset + delta.X,
                startPos.Y.Scale, 
                startPos.Y.Offset + delta.Y
            )
        end
    end)
    
    -- Content Area
    local contentFrame = Instance.new("Frame")
    contentFrame.Size = UDim2.new(1, 0, 1, -Sizes.titleHeight)
    contentFrame.Position = UDim2.new(0, 0, 0, Sizes.titleHeight)
    contentFrame.BackgroundTransparency = 1
    contentFrame.Parent = mainFrame
    
    -- Left Side - Positions List
    local positionsFrame = Instance.new("ScrollingFrame")
    positionsFrame.Size = UDim2.new(0.58, 0, 1, -40) -- Space for buttons below
    positionsFrame.Position = UDim2.new(0, 0, 0, 0)
    positionsFrame.BackgroundTransparency = 1
    positionsFrame.BorderSizePixel = 0
    positionsFrame.ScrollBarThickness = 3
    positionsFrame.ScrollBarImageColor3 = Theme.primary
    positionsFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
    positionsFrame.Name = "PositionsFrame"
    positionsFrame.Parent = contentFrame
    
    -- Right Side - Control Buttons
    local controlsFrame = Instance.new("Frame")
    controlsFrame.Size = UDim2.new(0.38, 0, 1, -40) -- Space for LOAD button
    controlsFrame.Position = UDim2.new(0.6, 0, 0, 0)
    controlsFrame.BackgroundTransparency = 1
    controlsFrame.Parent = contentFrame
    
    -- Control Buttons (Vertical)
    local startBtn = Instance.new("TextButton")
    startBtn.Size = UDim2.new(1, 0, 0, Sizes.buttonHeight)
    startBtn.Position = UDim2.new(0, 0, 0, Sizes.spacing)
    startBtn.BackgroundColor3 = Theme.primary
    startBtn.TextColor3 = Theme.secondary
    startBtn.Text = "START"
    startBtn.Font = Enum.Font.GothamBold
    startBtn.TextSize = 11
    startBtn.AutoButtonColor = false
    startBtn.Name = "StartBtn"
    startBtn.Parent = controlsFrame
    
    local startCorner = Instance.new("UICorner")
    startCorner.CornerRadius = UDim.new(0, 4)
    startCorner.Parent = startBtn
    
    local setPosBtn = Instance.new("TextButton")
    setPosBtn.Size = UDim2.new(1, 0, 0, Sizes.buttonHeight)
    setPosBtn.Position = UDim2.new(0, 0, 0, Sizes.buttonHeight + Sizes.spacing * 2)
    setPosBtn.BackgroundColor3 = Theme.primary
    setPosBtn.TextColor3 = Theme.secondary
    setPosBtn.Text = "SET POSISI"
    setPosBtn.Font = Enum.Font.GothamBold
    setPosBtn.TextSize = 10
    setPosBtn.AutoButtonColor = false
    setPosBtn.Name = "SetPosBtn"
    setPosBtn.Parent = controlsFrame
    
    local setPosCorner = Instance.new("UICorner")
    setPosCorner.CornerRadius = UDim.new(0, 4)
    setPosCorner.Parent = setPosBtn
    
    local stopBtn = Instance.new("TextButton")
    stopBtn.Size = UDim2.new(1, 0, 0, Sizes.buttonHeight)
    stopBtn.Position = UDim2.new(0, 0, 0, Sizes.buttonHeight * 2 + Sizes.spacing * 3)
    stopBtn.BackgroundColor3 = Theme.accent
    stopBtn.TextColor3 = Theme.secondary
    stopBtn.Text = "STOP"
    stopBtn.Font = Enum.Font.GothamBold
    stopBtn.TextSize = 11
    stopBtn.AutoButtonColor = false
    stopBtn.Name = "StopBtn"
    stopBtn.Parent = controlsFrame
    
    local stopCorner = Instance.new("UICorner")
    stopCorner.CornerRadius = UDim.new(0, 4)
    stopCorner.Parent = stopBtn
    
    -- LOAD Button at Bottom Right
    local loadBtn = Instance.new("TextButton")
    loadBtn.Size = UDim2.new(0.38, 0, 0, 30)
    loadBtn.Position = UDim2.new(0.6, 0, 1, -35)
    loadBtn.BackgroundColor3 = Theme.info
    loadBtn.TextColor3 = Theme.secondary
    loadBtn.Text = "LOAD"
    loadBtn.Font = Enum.Font.GothamBold
    loadBtn.TextSize = 11
    loadBtn.AutoButtonColor = false
    loadBtn.Name = "LoadBtn"
    loadBtn.Parent = contentFrame
    
    local loadCorner = Instance.new("UICorner")
    loadCorner.CornerRadius = UDim.new(0, 4)
    loadCorner.Parent = loadBtn
    
    loadBtn.MouseEnter:Connect(function()
        loadBtn.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
    end)
    
    loadBtn.MouseLeave:Connect(function()
        loadBtn.BackgroundColor3 = Theme.info
    end)
    
    -- Mini Icon
    local miniIcon = Instance.new("TextButton")
    miniIcon.Size = UDim2.new(0, 30, 0, 30)
    miniIcon.Position = UDim2.new(0, 10, 0, 10)
    miniIcon.BackgroundColor3 = Theme.primary
    miniIcon.TextColor3 = Theme.secondary
    miniIcon.Text = "V"
    miniIcon.Font = Enum.Font.GothamBold
    miniIcon.TextSize = 12
    miniIcon.AutoButtonColor = true
    miniIcon.Name = "MiniIcon"
    miniIcon.Visible = false
    miniIcon.ZIndex = 10
    miniIcon.Parent = screenGui
    
    local miniCorner = Instance.new("UICorner")
    miniCorner.CornerRadius = UDim.new(0, 6)
    miniCorner.Parent = miniIcon
    
    local miniStroke = Instance.new("UIStroke")
    miniStroke.Color = Theme.secondary
    miniStroke.Thickness = 1
    miniStroke.Parent = miniIcon
    
    -- Make Mini Icon Draggable
    local miniDragging = false
    local miniDragInput, miniDragStart, miniStartPos
    
    miniIcon.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            miniDragging = true
            miniDragStart = input.Position
            miniStartPos = miniIcon.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    miniDragging = false
                end
            end)
        end
    end)
    
    miniIcon.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            miniDragInput = input
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input == miniDragInput and miniDragging then
            local delta = input.Position - miniDragStart
            miniIcon.Position = UDim2.new(
                miniStartPos.X.Scale, 
                miniStartPos.X.Offset + delta.X,
                miniStartPos.Y.Scale, 
                miniStartPos.Y.Offset + delta.Y
            )
        end
    end)
    
    return screenGui, mainFrame, miniIcon
end

-- Update Positions List
function VenomSystem:updatePositionsList()
    local positionsFrame = self.gui:FindFirstChild("PositionsFrame", true)
    if not positionsFrame then return end
    
    for _, child in pairs(positionsFrame:GetChildren()) do
        if child:IsA("Frame") then
            child:Destroy()
        end
    end
    
    positionsFrame.CanvasSize = UDim2.new(0, 0, 0, #self.positions * (Sizes.posItemHeight + Sizes.spacing))
    
    for i, position in ipairs(self.positions) do
        local posFrame = Instance.new("Frame")
        posFrame.Size = UDim2.new(0.95, 0, 0, Sizes.posItemHeight)
        posFrame.Position = UDim2.new(0.025, 0, 0, (i - 1) * (Sizes.posItemHeight + Sizes.spacing))
        posFrame.BackgroundColor3 = Theme.secondary
        posFrame.BackgroundTransparency = 0.9
        posFrame.BorderSizePixel = 0
        posFrame.Parent = positionsFrame
        
        local posCorner = Instance.new("UICorner")
        posCorner.CornerRadius = UDim.new(0, 4)
        posCorner.Parent = posFrame
        
        local posStroke = Instance.new("UIStroke")
        posStroke.Color = Theme.primary
        posStroke.Thickness = 1
        posStroke.Parent = posFrame
        
        -- Position Label
        local posLabel = Instance.new("TextLabel")
        posLabel.Size = UDim2.new(0.45, 0, 1, 0)
        posLabel.Position = UDim2.new(0.05, 0, 0, 0)
        posLabel.BackgroundTransparency = 1
        posLabel.TextColor3 = Theme.secondary
        posLabel.Text = "P" .. i
        posLabel.Font = Enum.Font.GothamSemibold
        posLabel.TextSize = 10
        posLabel.TextXAlignment = Enum.TextXAlignment.Left
        posLabel.Parent = posFrame
        
        -- TP Button
        local tpBtn = Instance.new("TextButton")
        tpBtn.Size = UDim2.new(0.2, 0, 0.6, 0)
        tpBtn.Position = UDim2.new(0.5, 0, 0.2, 0)
        tpBtn.BackgroundColor3 = Theme.primary
        tpBtn.TextColor3 = Theme.secondary
        tpBtn.Text = "TP"
        tpBtn.Font = Enum.Font.GothamBold
        tpBtn.TextSize = 8
        tpBtn.AutoButtonColor = false
        tpBtn.Name = "TPBtn_" .. i
        tpBtn.Parent = posFrame
        
        local tpCorner = Instance.new("UICorner")
        tpCorner.CornerRadius = UDim.new(0, 3)
        tpCorner.Parent = tpBtn
        
        tpBtn.MouseEnter:Connect(function()
            tpBtn.BackgroundColor3 = Theme.accent
        end)
        
        tpBtn.MouseLeave:Connect(function()
            tpBtn.BackgroundColor3 = Theme.primary
        end)
        
        -- Delete Button
        local delBtn = Instance.new("TextButton")
        delBtn.Size = UDim2.new(0.2, 0, 0.6, 0)
        delBtn.Position = UDim2.new(0.75, 0, 0.2, 0)
        delBtn.BackgroundColor3 = Theme.warning
        delBtn.TextColor3 = Theme.secondary
        delBtn.Text = "X"
        delBtn.Font = Enum.Font.GothamBold
        delBtn.TextSize = 8
        delBtn.AutoButtonColor = false
        delBtn.Name = "DelBtn_" .. i
        delBtn.Parent = posFrame
        
        local delCorner = Instance.new("UICorner")
        delCorner.CornerRadius = UDim.new(0, 3)
        delCorner.Parent = delBtn
        
        delBtn.MouseEnter:Connect(function()
            delBtn.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
        end)
        
        delBtn.MouseLeave:Connect(function()
            delBtn.BackgroundColor3 = Theme.warning
        end)
        
        -- Button Events
        tpBtn.MouseButton1Click:Connect(function()
            directTeleport(i)
        end)
        
        delBtn.MouseButton1Click:Connect(function()
            deletePosition(i)
        end)
    end
end

-- Toggle Menu Visibility with Auto-Load
function VenomSystem:toggleMenu()
    self.menuVisible = not self.menuVisible
    self.mainFrame.Visible = self.menuVisible
    self.miniIcon.Visible = not self.menuVisible
    
    -- Auto load positions when opening menu
    if self.menuVisible then
        loadPositions()
    end
end

-- Setup Event Handlers
function VenomSystem:setupEvents()
    local closeBtn = self.gui:FindFirstChild("CloseBtn", true)
    local startBtn = self.gui:FindFirstChild("StartBtn", true)
    local setPosBtn = self.gui:FindFirstChild("SetPosBtn", true)
    local stopBtn = self.gui:FindFirstChild("StopBtn", true)
    local loadBtn = self.gui:FindFirstChild("LoadBtn", true)
    local miniIcon = self.gui:FindFirstChild("MiniIcon", true)
    
    if closeBtn then
        closeBtn.MouseButton1Click:Connect(function()
            self:toggleMenu()
        end)
    end
    
    if startBtn then
        startBtn.MouseButton1Click:Connect(function()
            if not self.isRunning then
                startAutoTeleport()
            end
        end)
    end
    
    if setPosBtn then
        setPosBtn.MouseButton1Click:Connect(function()
            addPosition()
        end)
    end
    
    if stopBtn then
        stopBtn.MouseButton1Click:Connect(function()
            stopAutoTeleport()
        end)
    end
    
    if loadBtn then
        loadBtn.MouseButton1Click:Connect(function()
            handleDoubleClick(loadBtn)
        end)
    end
    
    if miniIcon then
        miniIcon.MouseButton1Click:Connect(function()
            self:toggleMenu()
        end)
    end
end

-- Initialize System with Auto-Load
function VenomSystem:init()
    local screenGui, mainFrame, miniIcon = self:createGUI()
    self.gui = screenGui
    self.mainFrame = mainFrame
    self.miniIcon = miniIcon
    
    self:setupEvents()
    loadPositions() -- Auto-load on startup
    
    print("V3N0M Advanced v1.0 - Ready")
    print("Features: Checkpoint Detection, Auto-Save/Load, Double-Click LOAD")
end

-- Start the System
VenomSystem:init()
