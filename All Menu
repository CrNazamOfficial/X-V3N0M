
local TweenService = game:GetService("TweenService")
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")

local TeleportV1 = {
    positions = {},
    maxPositions = 10,
    currentSelected = 1,
    antiCheatBypass = true,
    deleteMode = false,
    menuVisible = true,
    gui = nil,
    mainFrame = nil,
    menuIcon = nil,
    teleporting = false,
    lastTeleport = 0,
    cooldown = 0.3,
    ghostMode = false,
    ghostPaused = false,
    ghostConnection = nil,
    ghostDelay = 0.4,
    realPosition = nil
}

local GUI = {
    mainColor = Color3.fromRGB(20, 20, 20),
    secondaryColor = Color3.fromRGB(255, 255, 255),
    accentColor = Color3.fromRGB(200, 0, 0),
    successColor = Color3.fromRGB(0, 180, 0),
    warningColor = Color3.fromRGB(255, 50, 50),
    ghostColor = Color3.fromRGB(138, 43, 226),
    pauseColor = Color3.fromRGB(255, 165, 0)
}

local Sizes = {
    mainFrame = UDim2.new(0, 280, 0, 360),
    titleHeight = 32,
    posFrameSize = UDim2.new(0.46, 0, 0, 62),
    buttonHeight = 26,
    spacing = 6,
    menuIconSize = 40
}

local function savePositions()
    local saveData = {}
    for i, cframe in pairs(TeleportV1.positions) do
        if cframe then
            saveData[tostring(i)] = {
                x = cframe.X, y = cframe.Y, z = cframe.Z,
                rx = cframe.RightVector.X, ry = cframe.RightVector.Y, rz = cframe.RightVector.Z,
                ux = cframe.UpVector.X, uy = cframe.UpVector.Y, uz = cframe.UpVector.Z,
                lx = -cframe.LookVector.X, ly = -cframe.LookVector.Y, lz = -cframe.LookVector.Z
            }
        end
    end
    
    pcall(function()
        writefile("TeleportV1_Positions.json", game:GetService("HttpService"):JSONEncode(saveData))
    end)
    return true
end

local function loadPositions()
    local success = pcall(function()
        if isfile("TeleportV1_Positions.json") then
            local data = game:GetService("HttpService"):JSONDecode(readfile("TeleportV1_Positions.json"))
            TeleportV1.positions = {}
            
            for key, value in pairs(data) do
                local index = tonumber(key)
                if index then
                    TeleportV1.positions[index] = CFrame.new(
                        value.x, value.y, value.z,
                        value.rx, value.ry, value.rz,
                        value.ux, value.uy, value.uz,
                        value.lx, value.ly, value.lz
                    )
                end
            end
            
            TeleportV1:updateGUI()
            return true
        end
    end)
    
    return success
end

local function bypassAntiCheat()
    if not TeleportV1.antiCheatBypass then return end
    
    pcall(function()
        if not getgenv().namecallHooked then
            local oldNamecall
            oldNamecall = hookmetamethod(game, "__namecall", function(self, ...)
                local method = getnamecallmethod()
                
                if method and tostring(method):lower():find("teleport") then
                    return true
                end
                
                if method and (tostring(method):lower():find("check") or tostring(method):lower():find("validate")) then
                    return true
                end
                
                if method and (tostring(method):lower():find("kick") or tostring(method):lower():find("report")) then
                    return nil
                end
                
                return oldNamecall(self, ...)
            end)
            getgenv().namecallHooked = true
        end
    end)
    
    pcall(function()
        if not getgenv().indexHooked then
            local oldIndex
            oldIndex = hookmetamethod(game, "__index", function(self, key)
                if tostring(key):lower():find("position") or tostring(key):lower():find("cframe") then
                    if TeleportV1.teleporting or TeleportV1.ghostMode then
                        return oldIndex(self, key)
                    end
                end
                return oldIndex(self, key)
            end)
            getgenv().indexHooked = true
        end
    end)
end

local function stabilizeCharacter(character)
    if not character then return end
    
    pcall(function()
        local humanoid = character:FindFirstChildOfClass("Humanoid")
        local rootPart = character:FindFirstChild("HumanoidRootPart")
        
        if humanoid and rootPart then
            rootPart.Anchored = true
            rootPart.Velocity = Vector3.new(0, 0, 0)
            rootPart.RotVelocity = Vector3.new(0, 0, 0)
            rootPart.AssemblyLinearVelocity = Vector3.new(0, 0, 0)
            rootPart.AssemblyAngularVelocity = Vector3.new(0, 0, 0)
            humanoid:ChangeState(Enum.HumanoidStateType.GettingUp)
            wait(0.05)
            rootPart.Anchored = false
            humanoid:ChangeState(Enum.HumanoidStateType.Landed)
        end
    end)
end

function TeleportV1:startGhostMode()
    local validPositions = {}
    for i = 1, self.maxPositions do
        if self.positions[i] then
            table.insert(validPositions, i)
        end
    end
    
    if #validPositions < 2 then
        return false
    end
    
    self.ghostMode = true
    self.ghostPaused = false
    bypassAntiCheat()
    
    local player = Players.LocalPlayer
    local currentIndex = 1
    
    local ghostBtn = self.gui:FindFirstChild("GhostBtn", true)
    if ghostBtn then
        ghostBtn.Text = "PAUSE"
        ghostBtn.BackgroundColor3 = GUI.pauseColor
    end
    
    spawn(function()
        while self.ghostMode do
            if not self.ghostPaused then
                local character = player.Character
                if character then
                    local rootPart = character:FindFirstChild("HumanoidRootPart")
                    if rootPart then
                        if not self.realPosition then
                            self.realPosition = rootPart.CFrame
                        end
                        
                        local targetIndex = validPositions[currentIndex]
                        if self.positions[targetIndex] then
                            pcall(function()
                                rootPart.CFrame = self.positions[targetIndex]
                            end)
                            
                            wait(0.15) 
                            
                            if self.realPosition then
                                pcall(function()
                                    rootPart.CFrame = self.realPosition
                                end)
                            end
                            
                            currentIndex = currentIndex + 1
                            if currentIndex > #validPositions then
                                currentIndex = 1
                            end
                        end
                    end
                end
            end
            
            wait(self.ghostDelay)
        end
    end)
    
    spawn(function()
        while self.ghostMode do
            wait(0.1)
            if not self.ghostPaused then
                local character = player.Character
                if character then
                    local rootPart = character:FindFirstChild("HumanoidRootPart")
                    if rootPart then
                        local humanoid = character:FindFirstChildOfClass("Humanoid")
                        if humanoid and humanoid.MoveDirection.Magnitude > 0 then
                            self.realPosition = rootPart.CFrame
                        end
                    end
                end
            end
        end
    end)
    
    return true
end

function TeleportV1:pauseGhostMode()
    self.ghostPaused = true
    
    local ghostBtn = self.gui:FindFirstChild("GhostBtn", true)
    if ghostBtn then
        ghostBtn.Text = "LANJUT"
        ghostBtn.BackgroundColor3 = GUI.successColor
    end
end

function TeleportV1:resumeGhostMode()
    self.ghostPaused = false
    
    local ghostBtn = self.gui:FindFirstChild("GhostBtn", true)
    if ghostBtn then
        ghostBtn.Text = "PAUSE"
        ghostBtn.BackgroundColor3 = GUI.pauseColor
    end
end

function TeleportV1:stopGhostMode()
    self.ghostMode = false
    self.ghostPaused = false
    
    if self.realPosition then
        local player = Players.LocalPlayer
        local character = player.Character
        if character then
            local rootPart = character:FindFirstChild("HumanoidRootPart")
            if rootPart then
                pcall(function()
                    rootPart.CFrame = self.realPosition
                end)
            end
        end
        self.realPosition = nil
    end
    
    local ghostBtn = self.gui:FindFirstChild("GhostBtn", true)
    if ghostBtn then
        ghostBtn.Text = "GHOST"
        ghostBtn.BackgroundColor3 = GUI.ghostColor
    end
end

function TeleportV1:createMenuIcon()
    local menuIcon = Instance.new("TextButton")
    menuIcon.Size = UDim2.new(0, Sizes.menuIconSize, 0, Sizes.menuIconSize)
    menuIcon.Position = UDim2.new(0, 15, 0, 15)
    menuIcon.BackgroundColor3 = GUI.accentColor
    menuIcon.TextColor3 = GUI.secondaryColor
    menuIcon.Text = "☰"
    menuIcon.Font = Enum.Font.GothamBold
    menuIcon.TextSize = 16
    menuIcon.AutoButtonColor = true
    menuIcon.Name = "MenuIcon"
    menuIcon.ZIndex = 10
    menuIcon.Visible = false
    menuIcon.Parent = self.gui
    
    local iconCorner = Instance.new("UICorner")
    iconCorner.CornerRadius = UDim.new(0, 6)
    iconCorner.Parent = menuIcon
    
    local iconStroke = Instance.new("UIStroke")
    iconStroke.Color = GUI.secondaryColor
    iconStroke.Thickness = 2
    iconStroke.Parent = menuIcon
    
    local dragging = false
    local dragInput, dragStart, startPos
    
    menuIcon.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = menuIcon.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    menuIcon.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            menuIcon.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
    
    menuIcon.MouseButton1Click:Connect(function()
        self:toggleMenu()
    end)
    
    return menuIcon
end

function TeleportV1:createMainFrame()
    local mainFrame = Instance.new("Frame")
    mainFrame.Size = Sizes.mainFrame
    mainFrame.Position = UDim2.new(0.5, -Sizes.mainFrame.X.Offset/2, 0.5, -Sizes.mainFrame.Y.Offset/2)
    mainFrame.BackgroundColor3 = GUI.mainColor
    mainFrame.BackgroundTransparency = 0.05
    mainFrame.BorderSizePixel = 0
    mainFrame.ClipsDescendants = false
    mainFrame.Visible = true
    mainFrame.Name = "MainFrame"
    mainFrame.Parent = self.gui
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 6)
    corner.Parent = mainFrame
    
    local stroke = Instance.new("UIStroke")
    stroke.Color = GUI.accentColor
    stroke.Thickness = 2
    stroke.Parent = mainFrame
    
    local titleBar = Instance.new("Frame")
    titleBar.Size = UDim2.new(1, 0, 0, Sizes.titleHeight)
    titleBar.Position = UDim2.new(0, 0, 0, 0)
    titleBar.BackgroundColor3 = GUI.accentColor
    titleBar.BorderSizePixel = 0
    titleBar.Name = "TitleBar"
    titleBar.Parent = mainFrame
    
    local titleCorner = Instance.new("UICorner")
    titleCorner.CornerRadius = UDim.new(0, 6)
    titleCorner.Parent = titleBar
    
    local bottomFix = Instance.new("Frame")
    bottomFix.Size = UDim2.new(1, 0, 0, 6)
    bottomFix.Position = UDim2.new(0, 0, 1, -6)
    bottomFix.BackgroundColor3 = GUI.accentColor
    bottomFix.BorderSizePixel = 0
    bottomFix.Parent = titleBar
    
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Size = UDim2.new(0.65, 0, 1, 0)
    titleLabel.Position = UDim2.new(0.05, 0, 0, 0)
    titleLabel.BackgroundTransparency = 1
    titleLabel.TextColor3 = GUI.secondaryColor
    titleLabel.Text = "TP V1 - Nazam"
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.TextSize = 11
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.Parent = titleBar
    
    local minimizeBtn = Instance.new("TextButton")
    minimizeBtn.Size = UDim2.new(0, 24, 0, 24)
    minimizeBtn.Position = UDim2.new(1, -28, 0.5, -12)
    minimizeBtn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    minimizeBtn.TextColor3 = GUI.secondaryColor
    minimizeBtn.Text = "−"
    minimizeBtn.Font = Enum.Font.GothamBold
    minimizeBtn.TextSize = 14
    minimizeBtn.AutoButtonColor = false
    minimizeBtn.Name = "MinimizeBtn"
    minimizeBtn.Parent = titleBar
    
    local minimizeCorner = Instance.new("UICorner")
    minimizeCorner.CornerRadius = UDim.new(0, 4)
    minimizeCorner.Parent = minimizeBtn
    
    minimizeBtn.MouseEnter:Connect(function()
        minimizeBtn.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
    end)
    
    minimizeBtn.MouseLeave:Connect(function()
        minimizeBtn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    end)
    
    minimizeBtn.MouseButton1Click:Connect(function()
        self:toggleMenu()
    end)
    
    local dragging = false
    local dragInput, dragStart, startPos
    
    titleBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = mainFrame.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    titleBar.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
    end)
    
    return mainFrame
end

function TeleportV1:createGUI()
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "TeleportV1_NazamOfficial"
    screenGui.ResetOnSpawn = false
    screenGui.Parent = Players.LocalPlayer:WaitForChild("PlayerGui")
    
    self.gui = screenGui
    self.mainFrame = self:createMainFrame()
    self.menuIcon = self:createMenuIcon()
    
    local scrollFrame = Instance.new("ScrollingFrame")
    scrollFrame.Size = UDim2.new(1, 0, 1, -Sizes.titleHeight - 65)
    scrollFrame.Position = UDim2.new(0, 0, 0, Sizes.titleHeight)
    scrollFrame.BackgroundTransparency = 1
    scrollFrame.BorderSizePixel = 0
    scrollFrame.ScrollBarThickness = 3
    scrollFrame.ScrollBarImageColor3 = GUI.accentColor
    scrollFrame.CanvasSize = UDim2.new(0, 0, 0, 360)
    scrollFrame.Name = "ScrollFrame"
    scrollFrame.Parent = self.mainFrame
    
    for i = 1, self.maxPositions do
        local row = math.floor((i - 1) / 2)
        local col = (i - 1) % 2
        
        local xPos = 0.04 + (col * 0.50)
        local yPos = Sizes.spacing + (row * 68)
        
        local posFrame = Instance.new("Frame")
        posFrame.Size = Sizes.posFrameSize
        posFrame.Position = UDim2.new(xPos, 0, 0, yPos)
        posFrame.BackgroundColor3 = GUI.secondaryColor
        posFrame.BackgroundTransparency = 0.9
        posFrame.BorderSizePixel = 0
        posFrame.Name = "PosFrame"..i
        posFrame.Parent = scrollFrame
        
        local posFrameCorner = Instance.new("UICorner")
        posFrameCorner.CornerRadius = UDim.new(0, 5)
        posFrameCorner.Parent = posFrame
        
        local posFrameStroke = Instance.new("UIStroke")
        posFrameStroke.Color = GUI.accentColor
        posFrameStroke.Thickness = 1
        posFrameStroke.Parent = posFrame
        
        local posLabel = Instance.new("TextLabel")
        posLabel.Size = UDim2.new(0.65, 0, 0.22, 0)
        posLabel.Position = UDim2.new(0.05, 0, 0.05, 0)
        posLabel.BackgroundTransparency = 1
        posLabel.TextColor3 = GUI.warningColor
        posLabel.Text = "P"..i
        posLabel.Font = Enum.Font.GothamBold
        posLabel.TextSize = 9
        posLabel.TextXAlignment = Enum.TextXAlignment.Left
        posLabel.Name = "PosLabel"..i
        posLabel.Parent = posFrame
        
        local statusIndicator = Instance.new("Frame")
        statusIndicator.Size = UDim2.new(0.65, 0, 0, 2)
        statusIndicator.Position = UDim2.new(0.05, 0, 0.3, 0)
        statusIndicator.BackgroundColor3 = GUI.warningColor
        statusIndicator.BorderSizePixel = 0
        statusIndicator.Name = "StatusIndicator"..i
        statusIndicator.Parent = posFrame
        
        local teleportBtn = Instance.new("TextButton")
        teleportBtn.Size = UDim2.new(0.9, 0, 0.28, 0)
        teleportBtn.Position = UDim2.new(0.05, 0, 0.37, 0)
        teleportBtn.BackgroundColor3 = GUI.accentColor
        teleportBtn.TextColor3 = GUI.secondaryColor
        teleportBtn.Text = "TP"
        teleportBtn.Font = Enum.Font.GothamBold
        teleportBtn.TextSize = 8
        teleportBtn.AutoButtonColor = false
        teleportBtn.Name = "TeleportBtn"..i
        teleportBtn.Parent = posFrame
        
        local teleportCorner = Instance.new("UICorner")
        teleportCorner.CornerRadius = UDim.new(0, 3)
        teleportCorner.Parent = teleportBtn
        
        teleportBtn.MouseEnter:Connect(function()
            teleportBtn.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
        end)
        
        teleportBtn.MouseLeave:Connect(function()
            teleportBtn.BackgroundColor3 = GUI.accentColor
        end)
        
        local setBtn = Instance.new("TextButton")
        setBtn.Size = UDim2.new(0.9, 0, 0.28, 0)
        setBtn.Position = UDim2.new(0.05, 0, 0.68, 0)
        setBtn.BackgroundColor3 = Color3.fromRGB(0, 150, 0)
        setBtn.TextColor3 = GUI.secondaryColor
        setBtn.Text = "SET"
        setBtn.Font = Enum.Font.GothamBold
        setBtn.TextSize = 8
        setBtn.AutoButtonColor = false
        setBtn.Name = "SetBtn"..i
        setBtn.Parent = posFrame
        
        local setCorner = Instance.new("UICorner")
        setCorner.CornerRadius = UDim.new(0, 3)
        setCorner.Parent = setBtn
        
        setBtn.MouseEnter:Connect(function()
            setBtn.BackgroundColor3 = Color3.fromRGB(0, 200, 0)
        end)
        
        setBtn.MouseLeave:Connect(function()
            setBtn.BackgroundColor3 = Color3.fromRGB(0, 150, 0)
        end)
        
        local deleteBtn = Instance.new("TextButton")
        deleteBtn.Size = UDim2.new(0, 18, 0, 18)
        deleteBtn.Position = UDim2.new(1, -22, 0, 4)
        deleteBtn.BackgroundColor3 = GUI.accentColor
        deleteBtn.TextColor3 = GUI.secondaryColor
        deleteBtn.Text = "✕"
        deleteBtn.Font = Enum.Font.GothamBold
        deleteBtn.TextSize = 10
        deleteBtn.AutoButtonColor = false
        deleteBtn.Name = "DeleteBtn"..i
        deleteBtn.Visible = false
        deleteBtn.ZIndex = 2
        deleteBtn.Parent = posFrame
        
        local deleteCorner = Instance.new("UICorner")
        deleteCorner.CornerRadius = UDim.new(0, 9)
        deleteCorner.Parent = deleteBtn
        
        deleteBtn.MouseEnter:Connect(function()
            deleteBtn.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
        end)
        
        deleteBtn.MouseLeave:Connect(function()
            deleteBtn.BackgroundColor3 = GUI.accentColor
        end)
    end

    local controlFrame = Instance.new("Frame")
    controlFrame.Size = UDim2.new(1, 0, 0, 65)
    controlFrame.Position = UDim2.new(0, 0, 1, -65)
    controlFrame.BackgroundTransparency = 1
    controlFrame.Parent = self.mainFrame
    
    local deleteModeBtn = Instance.new("TextButton")
    deleteModeBtn.Size = UDim2.new(0.22, 0, 0, Sizes.buttonHeight)
    deleteModeBtn.Position = UDim2.new(0.04, 0, 0.12, 0)
    deleteModeBtn.BackgroundColor3 = GUI.accentColor
    deleteModeBtn.TextColor3 = GUI.secondaryColor
    deleteModeBtn.Text = "DEL"
    deleteModeBtn.Font = Enum.Font.GothamBold
    deleteModeBtn.TextSize = 9
    deleteModeBtn.AutoButtonColor = false
    deleteModeBtn.Name = "DeleteModeBtn"
    deleteModeBtn.Parent = controlFrame
    
    local deleteModeCorner = Instance.new("UICorner")
    deleteModeCorner.CornerRadius = UDim.new(0, 5)
    deleteModeCorner.Parent = deleteModeBtn
    
    local saveBtn = Instance.new("TextButton")
    saveBtn.Size = UDim2.new(0.22, 0, 0, Sizes.buttonHeight)
    saveBtn.Position = UDim2.new(0.28, 0, 0.12, 0)
    saveBtn.BackgroundColor3 = Color3.fromRGB(0, 120, 200)
    saveBtn.TextColor3 = GUI.secondaryColor
    saveBtn.Text = "SAV"
    saveBtn.Font = Enum.Font.GothamBold
    saveBtn.TextSize = 9
    saveBtn.AutoButtonColor = false
    saveBtn.Name = "SaveBtn"
    saveBtn.Parent = controlFrame
    
    local saveCorner = Instance.new("UICorner")
    saveCorner.CornerRadius = UDim.new(0, 5)
    saveCorner.Parent = saveBtn
    
    local loadBtn = Instance.new("TextButton")
    loadBtn.Size = UDim2.new(0.22, 0, 0, Sizes.buttonHeight)
    loadBtn.Position = UDim2.new(0.52, 0, 0.12, 0)
    loadBtn.BackgroundColor3 = Color3.fromRGB(0, 150, 0)
    loadBtn.TextColor3 = GUI.secondaryColor
    loadBtn.Text = "LOD"
    loadBtn.Font = Enum.Font.GothamBold
    loadBtn.TextSize = 9
    loadBtn.AutoButtonColor = false
    loadBtn.Name = "LoadBtn"
    loadBtn.Parent = controlFrame
    
    local loadCorner = Instance.new("UICorner")
    loadCorner.CornerRadius = UDim.new(0, 5)
    loadCorner.Parent = loadBtn
    
    local ghostBtn = Instance.new("TextButton")
    ghostBtn.Size = UDim2.new(0.22, 0, 0, Sizes.buttonHeight)
    ghostBtn.Position = UDim2.new(0.76, 0, 0.12, 0)
    ghostBtn.BackgroundColor3 = GUI.ghostColor
    ghostBtn.TextColor3 = GUI.secondaryColor
    ghostBtn.Text = "GHO"
    ghostBtn.Font = Enum.Font.GothamBold
    ghostBtn.TextSize = 9
    ghostBtn.AutoButtonColor = false
    ghostBtn.Name = "GhostBtn"
    ghostBtn.Parent = controlFrame
    
    local ghostCorner = Instance.new("UICorner")
    ghostCorner.CornerRadius = UDim.new(0, 5)
    ghostCorner.Parent = ghostBtn
    
    local infoLabel = Instance.new("TextLabel")
    infoLabel.Size = UDim2.new(0.92, 0, 0, 16)
    infoLabel.Position = UDim2.new(0.04, 0, 0.7, 0)
    infoLabel.BackgroundTransparency = 1
    infoLabel.TextColor3 = GUI.secondaryColor
    infoLabel.Text = "10 SLOTS + GHOST"
    infoLabel.Font = Enum.Font.GothamSemibold
    infoLabel.TextSize = 7
    infoLabel.TextXAlignment = Enum.TextXAlignment.Center
    infoLabel.Parent = controlFrame
    
    return screenGui
end

function TeleportV1:safeTeleport(targetCFrame)
    if not targetCFrame then return false end
    if tick() - self.lastTeleport < self.cooldown then return false end
    
    self.teleporting = true
    self.lastTeleport = tick()
    
    local player = Players.LocalPlayer
    local character = player.Character
    
    if not character then 
        self.teleporting = false
        return false 
    end
    
    local rootPart = character:FindFirstChild("HumanoidRootPart")
    local humanoid = character:FindFirstChildOfClass("Humanoid")
    
    if not rootPart or not humanoid then 
        self.teleporting = false
        return false 
    end
    
    pcall(function()
        rootPart.Anchored = true
        rootPart.Velocity = Vector3.new(0, 0, 0)
        rootPart.RotVelocity = Vector3.new(0, 0, 0)
    end)
    
    wait(0.05)
    pcall(function() rootPart.CFrame = targetCFrame end)
    wait(0.05)
    pcall(function() character:SetPrimaryPartCFrame(targetCFrame) end)
    wait(0.05)
    pcall(function() rootPart.Position = targetCFrame.Position end)
    wait(0.1)
    
    stabilizeCharacter(character)
    
    wait(0.05)
    pcall(function() rootPart.CFrame = targetCFrame end)
    
    self.teleporting = false
    return true
end

function TeleportV1:setPosition(index)
    if index > self.maxPositions then return end
    
    local character = Players.LocalPlayer.Character
    if character and character:FindFirstChild("HumanoidRootPart") then
        self.positions[index] = character.HumanoidRootPart.CFrame
        self.currentSelected = index
        self:updateGUI()
        savePositions()
    end
end

function TeleportV1:teleportToPosition(index)
    if not self.positions[index] then return end
    bypassAntiCheat()
    self:safeTeleport(self.positions[index])
end

function TeleportV1:deletePosition(index)
    self.positions[index] = nil
    self:updateGUI()
    savePositions()
end

function TeleportV1:updateGUI()
    for i = 1, self.maxPositions do
        local posLabel = self.gui:FindFirstChild("PosLabel"..i, true)
        local statusIndicator = self.gui:FindFirstChild("StatusIndicator"..i, true)
        
        if posLabel and statusIndicator then
            if self.positions[i] then
                posLabel.Text = "P"..i.." ✓"
                posLabel.TextColor3 = GUI.successColor
                statusIndicator.BackgroundColor3 = GUI.successColor
            else
                posLabel.Text = "P"..i
                posLabel.TextColor3 = GUI.warningColor
                statusIndicator.BackgroundColor3 = GUI.warningColor
            end
        end
    end
end

function TeleportV1:toggleMenu()
    self.menuVisible = not self.menuVisible
    self.mainFrame.Visible = self.menuVisible
    self.menuIcon.Visible = not self.menuVisible
end

function TeleportV1:setupEvents()
    for i = 1, self.maxPositions do
        local setBtn = self.gui:FindFirstChild("SetBtn"..i, true)
        local teleportBtn = self.gui:FindFirstChild("TeleportBtn"..i, true)
        local deleteBtn = self.gui:FindFirstChild("DeleteBtn"..i, true)
        
        if setBtn then
            setBtn.MouseButton1Click:Connect(function()
                self:setPosition(i)
            end)
        end
        
        if teleportBtn then
            teleportBtn.MouseButton1Click:Connect(function()
                self:teleportToPosition(i)
            end)
        end
        
        if deleteBtn then
            deleteBtn.MouseButton1Click:Connect(function()
                self:deletePosition(i)
                deleteBtn.Visible = false
            end)
        end
    end
    
    local deleteModeBtn = self.gui:FindFirstChild("DeleteModeBtn", true)
    if deleteModeBtn then
        deleteModeBtn.MouseButton1Click:Connect(function()
            self.deleteMode = not self.deleteMode
            for i = 1, self.maxPositions do
                local deleteBtn = self.gui:FindFirstChild("DeleteBtn"..i, true)
                if deleteBtn then deleteBtn.Visible = self.deleteMode end
            end
            
            if self.deleteMode then
                deleteModeBtn.Text = "X"
                deleteModeBtn.BackgroundColor3 = Color3.fromRGB(255, 100, 0)
            else
                deleteModeBtn.Text = "DEL"
                deleteModeBtn.BackgroundColor3 = GUI.accentColor
            end
        end)
    end
    
    local saveBtn = self.gui:FindFirstChild("SaveBtn", true)
    if saveBtn then
        saveBtn.MouseButton1Click:Connect(function()
            savePositions()
        end)
    end
    
    local loadBtn = self.gui:FindFirstChild("LoadBtn", true)
    if loadBtn then
        loadBtn.MouseButton1Click:Connect(function()
            loadPositions()
        end)
    end
    
    local ghostBtn = self.gui:FindFirstChild("GhostBtn", true)
    if ghostBtn then
        ghostBtn.MouseButton1Click:Connect(function()
            if not self.ghostMode then
                self:startGhostMode()
            elseif self.ghostPaused then
                self:resumeGhostMode()
            else
                if ghostBtn.Text == "PAUSE" then
                    self:pauseGhostMode()
                else
                    self:stopGhostMode()
                end
            end
        end)
    end
end

function TeleportV1:init()
    self.gui = self:createGUI()
    self:setupEvents()
    bypassAntiCheat()
    loadPositions()
    
    print("✅ Teleport V1.0 Loaded - By Nazam Official")
    print("✅ 10 SLOTS + GHOST MODE + AUTO-SAVE")
    print("✅ COMPACT SIZE - DRAGGABLE")
end

TeleportV1:init()
